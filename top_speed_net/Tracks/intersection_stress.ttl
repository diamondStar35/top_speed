# Intersection-heavy stress test track
[meta]
name="Intersection Stress"
author=TopSpeed
version=1.0
tags=stress,intersection

[environment]
weather=sunny
ambience=noambience
default_surface=asphalt
default_noise=nonoise
default_width=12
sample_spacing=0.5
enforce_closure=true
primary_route=main_loop

[nodes]
id=hub_a
id=hub_b
id=hub_c
id=spur_d

[edges]
id=e_ab from=hub_a to=hub_b
id=e_bc from=hub_b to=hub_c
id=e_ca from=hub_c to=hub_a
id=e_bd from=hub_b to=spur_d
id=e_db from=spur_d to=hub_b

[routes]
id=main_loop edges=e_ab,e_bc,e_ca is_loop=true
id=spur_loop edges=e_bd,e_db is_loop=true

[start_finish sf_main]
edge=e_ab start=40 end=60 width=12 kind=start_finish heading=0 surface=asphalt priority=1

[start_finish sf_main.lanes]
id=sf_lane_0 index=0 width=3.6 center_offset=-1.8 direction=forward marking_left=solid marking_right=dashed speed_limit=80 surface=asphalt
id=sf_lane_1 index=1 width=3.6 center_offset=1.8 direction=forward marking_left=dashed marking_right=solid speed_limit=80 surface=asphalt

[start_finish sf_main.lane_links]
id=sf_link_0 from=sf_lane_0 to=sf_lane_0 turn=straight
id=sf_link_1 from=sf_lane_1 to=sf_lane_1 turn=straight

[start_finish sf_main.lane_groups]
id=g_sf_grid kind=custom owner=sf_main lanes=sf_lane_0,sf_lane_1 lane_count=2 width=7.2
id=g_sf_run kind=custom owner=sf_main lane_count=2 width=7.2 turn=straight

[start_finish sf_main.lane_transitions]
id=tx_grid_to_run from=g_sf_grid to=g_sf_run turn=straight from_lanes=sf_lane_0,sf_lane_1

[start_finish sf_main.areas]
id=start_line shape=box kind=start_line width=12 length=0.5 offset=0,-5 heading=90 lane_ids=sf_lane_0,sf_lane_1 thickness=0.3 priority=5
id=finish_line shape=box kind=finish_line width=12 length=0.5 offset=0,5 heading=90 lane_ids=sf_lane_0,sf_lane_1 thickness=0.3 priority=5
id=grid_0 shape=box kind=grid_box width=3.6 length=6 offset=-1.8,-2.5 owner_kind=lane_group owner=g_sf_grid lane_ids=sf_lane_0 thickness=0.2 priority=2
id=grid_1 shape=box kind=grid_box width=3.6 length=6 offset=1.8,-2.5 owner_kind=lane_group owner=g_sf_grid lane_ids=sf_lane_1 thickness=0.2 priority=2
id=timing_gate shape=box kind=timing_gate width=12 length=1 offset=0,0 heading=90 thickness=0.2 priority=4

[pit pit_hub_b]
node=hub_b
entry_edge=e_ab
exit_edge=e_bc
entry_s=400
exit_s=30
length=120
speed_limit=60
priority=1

[pit pit_hub_b.entry_lane]
start=0 end=60 width=5 offset=-3 direction=forward speed_limit=60

[pit pit_hub_b.exit_lane]
start=60 end=120 width=5 offset=-3 direction=forward speed_limit=60

[pit pit_hub_b.boxes]
id=box_1 position=25 width=3 length=7 offset=-2 team=alpha
id=box_2 position=55 width=3 length=7 offset=-2 team=beta

[pit pit_hub_b.blend_line]
position=90 length=25 side=right offset=-2 width=5

[node hub_a.intersection]
shape=Circle radius=12 entry_lanes=2 exit_lanes=2 turn_lanes=1 speed_limit=40 control=Yield priority=1

[node hub_a.legs]
id=leg_ca edge=e_ca type=both lanes=2 heading=90 offset=0,-20 width=7.2 approach_length=30
id=leg_ab edge=e_ab type=both lanes=2 heading=270 offset=0,20 width=7.2 approach_length=30

[node hub_a.connectors]
id=c_ca_ab from=leg_ca to=leg_ab turn=straight radius=20 length=30 lanes=2 points="0,-20|0,0|0,20"

[node hub_a.areas]
id=core shape=circle kind=core radius=6 owner_kind=custom owner=hub_a_core priority=1
id=stop_ca shape=box kind=stop_line width=7.2 length=0.6 offset=0,-12 heading=90 leg=leg_ca thickness=0.4 priority=1
id=stop_ab shape=box kind=stop_line width=7.2 length=0.6 offset=0,12 heading=270 leg=leg_ab thickness=0.4 priority=1

[node hub_b.intersection]
shape=Cross radius=18 entry_lanes=4 exit_lanes=4 turn_lanes=2 speed_limit=50 control=Signal priority=2

[node hub_b.legs]
id=leg_ab edge=e_ab type=both lanes=2 heading=180 offset=-30,0 width=7.2 approach_length=40
id=leg_bc edge=e_bc type=both lanes=2 heading=0 offset=30,0 width=7.2 approach_length=40
id=leg_bd edge=e_bd type=both lanes=2 heading=90 offset=0,30 width=7.2 approach_length=40
id=leg_db edge=e_db type=entry lanes=2 heading=270 offset=0,-30 width=7.2 approach_length=40

[node hub_b.connectors]
id=c_ab_bc from=leg_ab to=leg_bc turn=straight radius=50 length=40 lanes=2 points="-30,0|-10,0|10,0|30,0"
id=c_ab_bd from=leg_ab to=leg_bd turn=right radius=35 length=35 lanes=1 points="-30,0|-20,10|-10,20|0,30"
id=c_db_bc from=leg_db to=leg_bc turn=left radius=35 length=35 lanes=1 points="0,-30|10,-20|20,-10|30,0"
id=c_db_bd from=leg_db to=leg_bd turn=straight radius=40 length=40 lanes=2 points="0,-30|0,-10|0,10|0,30"
id=c_bc_ab from=leg_bc to=leg_ab turn=straight radius=50 length=40 lanes=2 points="30,0|10,0|-10,0|-30,0"
id=c_bd_ab from=leg_bd to=leg_ab turn=left radius=35 length=35 lanes=1 points="0,30|-10,20|-20,10|-30,0"

[node hub_b.lanes]
id=lane_ab_0 leg=leg_ab index=0 width=3.6 center_offset=-1.8 direction=forward marking_left=solid marking_right=dashed centerline=-30,0|-10,0
id=lane_ab_1 leg=leg_ab index=1 width=3.6 center_offset=1.8 direction=forward marking_left=dashed marking_right=solid centerline=-30,-1.5|-10,-1.5
id=lane_bc_0 leg=leg_bc index=0 width=3.6 center_offset=-1.8 direction=forward marking_left=solid marking_right=dashed centerline=30,0|10,0
id=lane_bc_1 leg=leg_bc index=1 width=3.6 center_offset=1.8 direction=forward marking_left=dashed marking_right=solid centerline=30,1.5|10,1.5
id=lane_bd_0 leg=leg_bd index=0 width=3.6 center_offset=-1.8 direction=forward marking_left=solid marking_right=dashed centerline=0,30|0,10
id=lane_bd_1 leg=leg_bd index=1 width=3.6 center_offset=1.8 direction=forward marking_left=dashed marking_right=solid centerline=-1.5,30|-1.5,10
id=lane_db_0 leg=leg_db index=0 width=3.6 center_offset=-1.8 direction=forward marking_left=solid marking_right=dashed centerline=0,-30|0,-10
id=lane_db_1 leg=leg_db index=1 width=3.6 center_offset=1.8 direction=forward marking_left=dashed marking_right=solid centerline=1.5,-30|1.5,-10
id=lane_c_ab_bd_0 connector=c_ab_bd index=0 width=3.6 center_offset=0 direction=forward marking_left=solid marking_right=solid centerline=-30,0|-20,10|-10,20|0,30
id=lane_c_db_bc_0 connector=c_db_bc index=0 width=3.6 center_offset=0 direction=forward marking_left=solid marking_right=solid centerline=0,-30|10,-20|20,-10|30,0

[node hub_b.lane_links]
id=link_ab_bc_0 from=lane_ab_0 to=lane_bc_0 turn=straight lane_change=true change_length=20
id=link_ab_bd_1 from=lane_ab_1 to=lane_bd_1 turn=right lane_change=true change_length=15
id=link_db_bc_0 from=lane_db_0 to=lane_bc_0 turn=left lane_change=true change_length=15
id=link_db_bd_1 from=lane_db_1 to=lane_bd_1 turn=straight lane_change=true change_length=20
id=link_bc_ab_0 from=lane_bc_0 to=lane_ab_0 turn=straight lane_change=true change_length=20
id=link_bd_ab_0 from=lane_bd_0 to=lane_ab_0 turn=left lane_change=true change_length=15

[node hub_b.lane_groups]
id=g_leg_ab kind=leg owner=leg_ab lanes=lane_ab_0,lane_ab_1
id=g_leg_bc kind=leg owner=leg_bc lanes=lane_bc_0,lane_bc_1
id=g_leg_bd kind=leg owner=leg_bd lanes=lane_bd_0,lane_bd_1
id=g_leg_db kind=leg owner=leg_db lanes=lane_db_0,lane_db_1
id=g_c_ab_bc kind=connector owner=c_ab_bc lane_count=2 turn=straight
id=g_c_ab_bd kind=connector owner=c_ab_bd lanes=lane_c_ab_bd_0 lane_count=1 turn=right
id=g_c_db_bc kind=connector owner=c_db_bc lanes=lane_c_db_bc_0 lane_count=1 turn=left
id=g_c_db_bd kind=connector owner=c_db_bd lane_count=2 turn=straight
id=g_c_bc_ab kind=connector owner=c_bc_ab lane_count=2 turn=straight
id=g_c_bd_ab kind=connector owner=c_bd_ab lane_count=1 turn=left

[node hub_b.lane_transitions]
id=tx_ab_to_c_ab_bc from=g_leg_ab to=g_c_ab_bc turn=straight from_lanes=lane_ab_0,lane_ab_1
id=tx_c_ab_bc_to_bc from=g_c_ab_bc to=g_leg_bc turn=straight to_lanes=lane_bc_0,lane_bc_1
id=tx_ab_to_c_ab_bd from=g_leg_ab to=g_c_ab_bd turn=right from_lanes=lane_ab_1 to_lanes=lane_c_ab_bd_0
id=tx_c_ab_bd_to_bd from=g_c_ab_bd to=g_leg_bd turn=right from_lanes=lane_c_ab_bd_0 to_lanes=lane_bd_1
id=tx_db_to_c_db_bc from=g_leg_db to=g_c_db_bc turn=left from_lanes=lane_db_0 to_lanes=lane_c_db_bc_0
id=tx_c_db_bc_to_bc from=g_c_db_bc to=g_leg_bc turn=left from_lanes=lane_c_db_bc_0 to_lanes=lane_bc_0
id=tx_db_to_c_db_bd from=g_leg_db to=g_c_db_bd turn=straight from_lanes=lane_db_0,lane_db_1
id=tx_c_db_bd_to_bd from=g_c_db_bd to=g_leg_bd turn=straight to_lanes=lane_bd_0,lane_bd_1
id=tx_bc_to_c_bc_ab from=g_leg_bc to=g_c_bc_ab turn=straight from_lanes=lane_bc_0,lane_bc_1
id=tx_c_bc_ab_to_ab from=g_c_bc_ab to=g_leg_ab turn=straight to_lanes=lane_ab_0,lane_ab_1
id=tx_bd_to_c_bd_ab from=g_leg_bd to=g_c_bd_ab turn=left from_lanes=lane_bd_0
id=tx_c_bd_ab_to_ab from=g_c_bd_ab to=g_leg_ab turn=left to_lanes=lane_ab_0

[node hub_b.areas]
id=core shape=circle kind=core radius=12 owner_kind=custom owner=hub_b_core priority=1
id=conflict_main shape=box kind=conflict width=18 length=18 owner_kind=custom owner=hub_b_conflict lane_ids=lane_c_ab_bd_0,lane_c_db_bc_0 priority=5
id=conflict_ab_bd shape=box kind=conflict width=6 length=6 offset=-10,10 owner_kind=connector owner=c_ab_bd priority=4
id=conflict_db_bc shape=box kind=conflict width=6 length=6 offset=10,-10 owner_kind=connector owner=c_db_bc priority=4
id=conflict_db_bd shape=box kind=conflict width=8 length=8 offset=0,-6 owner_kind=lane_group owner=g_c_db_bd priority=3
id=conflict_leg_ab shape=box kind=conflict width=6 length=6 offset=-14,0 owner_kind=lane_group owner=g_leg_ab priority=2
id=island shape=box kind=island width=6 length=10 offset=0,0 owner_kind=custom owner=hub_b_island
id=stop_ab shape=box kind=stop_line width=7.2 length=0.6 offset=-12,0 heading=180 leg=leg_ab lane_ids=lane_ab_0,lane_ab_1 thickness=0.4 priority=2
id=stop_bc shape=box kind=stop_line width=7.2 length=0.6 offset=12,0 heading=0 leg=leg_bc lane_ids=lane_bc_0,lane_bc_1 thickness=0.4 priority=2
id=stop_bd shape=box kind=stop_line width=7.2 length=0.6 offset=0,12 heading=90 leg=leg_bd lane_ids=lane_bd_0,lane_bd_1 thickness=0.4 priority=2
id=stop_db shape=box kind=stop_line width=7.2 length=0.6 offset=0,-12 heading=270 leg=leg_db lane_ids=lane_db_0,lane_db_1 thickness=0.4 priority=2
id=crosswalk_n shape=polygon kind=crosswalk points="-5,8|5,8|5,10|-5,10" leg=leg_bd lane_ids=lane_bd_0,lane_bd_1 thickness=2 priority=1

[node hub_c.intersection]
shape=Box radius=10 entry_lanes=2 exit_lanes=2 turn_lanes=1 speed_limit=45 control=Stop priority=1

[node hub_c.legs]
id=leg_bc edge=e_bc type=both lanes=2 heading=180 offset=-20,0 width=7.2 approach_length=30
id=leg_ca edge=e_ca type=both lanes=2 heading=0 offset=20,0 width=7.2 approach_length=30

[node hub_c.connectors]
id=c_bc_ca from=leg_bc to=leg_ca turn=straight radius=25 length=30 lanes=2 points="-20,0|0,0|20,0"

[node hub_c.areas]
id=stop_bc shape=box kind=stop_line width=7.2 length=0.6 offset=-10,0 heading=180 leg=leg_bc thickness=0.4 priority=1
id=stop_ca shape=box kind=stop_line width=7.2 length=0.6 offset=10,0 heading=0 leg=leg_ca thickness=0.4 priority=1

[node spur_d.intersection]
shape=Circle radius=10 entry_lanes=1 exit_lanes=1 turn_lanes=1 speed_limit=30 control=Yield priority=1

[node spur_d.legs]
id=leg_bd edge=e_bd type=both lanes=1 heading=180 offset=-15,0 width=6.5 approach_length=25
id=leg_db edge=e_db type=both lanes=1 heading=0 offset=15,0 width=6.5 approach_length=25

[node spur_d.connectors]
id=c_bd_db from=leg_bd to=leg_db turn=straight radius=15 length=20 lanes=1 points="-15,0|0,0|15,0"

[node spur_d.areas]
id=core shape=circle kind=core radius=5 owner_kind=custom owner=spur_d_core priority=1
id=stop_bd shape=box kind=stop_line width=6.5 length=0.6 offset=-8,0 heading=180 leg=leg_bd thickness=0.4 priority=1
id=stop_db shape=box kind=stop_line width=6.5 length=0.6 offset=8,0 heading=0 leg=leg_db thickness=0.4 priority=1

[edge e_ab]
from=hub_a
to=hub_b
default_surface=asphalt
default_noise=nonoise
default_width=12
default_weather=sunny
default_ambience=noambience

[edge e_ab.geometry]
kind=straight length=200
kind=clothoid length=30 start=0 end=150 direction=right severity=normal
kind=arc length=80 radius=150 direction=right severity=normal bank=6
kind=clothoid length=30 start=150 end=0 direction=right severity=normal
kind=straight length=100

[edge e_bc]
from=hub_b
to=hub_c
default_surface=asphalt
default_noise=nonoise
default_width=12
default_weather=sunny
default_ambience=noambience

[edge e_bc.geometry]
kind=straight length=180
kind=clothoid length=30 start=0 end=120 direction=left severity=normal
kind=arc length=90 radius=120 direction=left severity=normal bank=5
kind=clothoid length=30 start=120 end=0 direction=left severity=normal
kind=straight length=120

[edge e_ca]
from=hub_c
to=hub_a
default_surface=asphalt
default_noise=nonoise
default_width=12
default_weather=sunny
default_ambience=noambience

[edge e_ca.geometry]
kind=straight length=160
kind=clothoid length=35 start=0 end=140 direction=right severity=medium
kind=arc length=90 radius=140 direction=right severity=medium bank=6
kind=clothoid length=35 start=140 end=0 direction=right severity=medium
kind=straight length=140

[edge e_bd]
from=hub_b
to=spur_d
default_surface=asphalt
default_noise=nonoise
default_width=10
default_weather=sunny
default_ambience=noambience

[edge e_bd.geometry]
kind=straight length=140
kind=clothoid length=25 start=0 end=100 direction=left severity=easy
kind=arc length=70 radius=100 direction=left severity=easy bank=4
kind=clothoid length=25 start=100 end=0 direction=left severity=easy
kind=straight length=90

[edge e_db]
from=spur_d
to=hub_b
default_surface=asphalt
default_noise=nonoise
default_width=10
default_weather=sunny
default_ambience=noambience

[edge e_db.geometry]
kind=straight length=160
kind=clothoid length=25 start=0 end=90 direction=right severity=easy
kind=arc length=70 radius=90 direction=right severity=easy bank=4
kind=clothoid length=25 start=90 end=0 direction=right severity=easy
kind=straight length=90

[corner c_ab_1]
edge=e_ab
start=200
end=340
name="Hub A Bend"

[corner c_ab_1.apexes]
id=apex_1 position=270 offset=-1 speed=110 priority=1

[corner c_ab_1.braking]
start=200 end=245 target_speed=120 decel_g=0.9 priority=1

[corner c_ab_1.acceleration]
start=280 end=340 target_speed=150 priority=1

[corner c_ab_1.racing_lines]
id=rl_ab_dry kind=dry points="200,-1.5,0,120|250,-1,0,110|300,-0.5,0,130|340,0,0,150"

[corner c_bc_1]
edge=e_bc
start=180
end=330
name="Hub B Left"

[corner c_bc_1.apexes]
id=apex_1 position=260 offset=1 speed=105 priority=1

[corner c_bc_1.braking]
start=180 end=230 target_speed=115 decel_g=0.85 priority=1

[corner c_bc_1.acceleration]
start=270 end=330 target_speed=145 priority=1

[corner c_bc_1.racing_lines]
id=rl_bc_dry kind=dry points="180,1.5,0,120|230,1,0,110|280,0.5,0,125|330,0,0,145"

[corner c_ca_1]
edge=e_ca
start=160
end=320
name="Return Right"

[corner c_ca_1.apexes]
id=apex_1 position=240 offset=-1.2 speed=108 priority=1

[corner c_ca_1.braking]
start=160 end=210 target_speed=118 decel_g=0.88 priority=1

[corner c_ca_1.acceleration]
start=260 end=320 target_speed=148 priority=1

[corner c_ca_1.racing_lines]
id=rl_ca_dry kind=dry points="160,-1.4,0,118|210,-1,0,110|260,-0.6,0,130|320,0,0,148"

[corner c_bd_1]
edge=e_bd
start=140
end=260
name="Spur Left"

[corner c_bd_1.apexes]
id=apex_1 position=200 offset=0.8 speed=90 priority=1

[corner c_bd_1.braking]
start=140 end=185 target_speed=95 decel_g=0.7 priority=1

[corner c_bd_1.acceleration]
start=215 end=260 target_speed=120 priority=1

[corner c_bd_1.racing_lines]
id=rl_bd_dry kind=dry points="140,0.8,0,95|190,0.4,0,90|230,0.2,0,105|260,0,0,120"

[corner c_db_1]
edge=e_db
start=160
end=280
name="Spur Right"

[corner c_db_1.apexes]
id=apex_1 position=220 offset=-0.8 speed=92 priority=1

[corner c_db_1.braking]
start=160 end=205 target_speed=96 decel_g=0.7 priority=1

[corner c_db_1.acceleration]
start=235 end=280 target_speed=122 priority=1

[corner c_db_1.racing_lines]
id=rl_db_dry kind=dry points="160,-0.8,0,96|210,-0.4,0,92|250,-0.2,0,108|280,0,0,122"
